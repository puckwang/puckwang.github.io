<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta property="og:title" content="利用 GPG 簽署 git commit">
<meta property="og:description" content="利用 GPG 簽署 git commit，讓 Github 顯示綠色小勾勾">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.puckwang.com/posts/2019/sign_git_commit_with_gpg/"><meta property="og:image" content="https://blog.puckwang.com/images/og_image.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2019-04-03T16:04:42+08:00">
<meta property="article:modified_time" content="2021-12-12T06:36:48+08:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.puckwang.com/images/og_image.png">
<meta name=twitter:title content="利用 GPG 簽署 git commit">
<meta name=twitter:description content="利用 GPG 簽署 git commit，讓 Github 顯示綠色小勾勾">
<script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-4827510547436807",enable_page_level_ads:!0})</script>
<title>
利用 GPG 簽署 git commit | Puck's Blog
</title>
<link rel=icon type=image/png href=https://blog.puckwang.com/images/favicon-128x128.png sizes="16x16 32x32 64x64 128x128">
<link rel=canonical href=https://blog.puckwang.com/posts/2019/sign_git_commit_with_gpg/>
<link href="https://fonts.googleapis.com/css?family=Montserrat|Oswald:400" rel=stylesheet>
<link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous>
<link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous>
<link rel=stylesheet href=https://blog.puckwang.com/css/bundle.min.5d5448d1820d6ff5f132cb3fde480cdf60aecc3c374bacdc000c3e1bb275845c.css integrity="sha256-XVRI0YINb/XxMss/3kgM32CuzDw3S6zcAAw+G7J1hFw=">
<link rel=me type=text/html href=//www.facebook.com/puckwang14>
<link rel=me type=text/html href=//twitter.com/puckwang14>
<link rel=me type=text/html href=//github.com/puckwang>
<link rel=me type=text/html href=//linkedin.com/in/puckwang>
<link rel=me type=text/html href="//stackoverflow.com/users/7699156/puckwang?tab=profile">
<link rel=me type=text/html href=//g.dev/puckwang>
<link rel=alternate type=application/rss+xml href=https://blog.puckwang.com/index.xml>
<meta charset=utf-8>
<meta name=author content="Puck Wang">
<meta name=copyright content="Copyright © 2017-2024, Puck Wang; all rights reserved.">
<meta name=description content="利用 GPG 簽署 git commit，讓 Github 顯示綠色小勾勾">
<script>(function(b,d,e,a,g){b[a]=b[a]||[],b[a].push({'gtm.start':(new Date).getTime(),event:'gtm.js'});var f=d.getElementsByTagName(e)[0],c=d.createElement(e),h=a!='dataLayer'?'&l='+a:'';c.async=!0,c.src='https://www.googletagmanager.com/gtm.js?id='+g+h,f.parentNode.insertBefore(c,f)})(window,document,'script','dataLayer','GTM-T7955DN')</script>
<script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","name":"利用 GPG 簽署 git commit","headline":"利用 GPG 簽署 git commit","alternativeHeadline":"","description":"利用 GPG 簽署 git commit，讓 Github 顯示綠色小勾勾","inLanguage":"zh-TW","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.puckwang.com\/posts\/2019\/sign_git_commit_with_gpg\/"},"author":{"@type":"Person","name":"Puck Wang","url":"https:\/\/blog.puckwang.com\/about\/"},"creator":{"@type":"Person","name":"Puck Wang"},"accountablePerson":{"@type":"Person","name":"Puck Wang"},"copyrightHolder":"Puck\u0027s Blog","copyrightYear":"2019","dateCreated":"2019-04-03T16:04:42.00Z","datePublished":"2019-04-03T16:04:42.00Z","dateModified":"2021-12-12T06:36:48.00Z","publisher":{"@type":"Organization","name":"Puck\u0027s Blog","url":"https:\/\/blog.puckwang.com\/","logo":{"@type":"ImageObject","url":"https:\/\/blog.puckwang.com\/images\/favicon-128x128.png","width":"128","height":"128"}},"image":{"@type":"ImageObject","@id":"https:\/\/blog.puckwang.com\/images\/hero-main.jpg","url":"https:\/\/blog.puckwang.com\/images\/hero-main.jpg"},"url":"https:\/\/blog.puckwang.com\/posts\/2019\/sign_git_commit_with_gpg\/","wordCount":"497","genre":["Github","Gitlab","GPG","Verified","git","身份識別"]}</script>
</head>
<body>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T7955DN" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript>
<nav class="navbar fixed-top navbar-expand-md navbar-dark bg-dark py-1 top-nav">
<div class=container>
<a class="navbar-brand pr-2" href=https://blog.puckwang.com/>
<img src=https://blog.puckwang.com/images/logo.png width=40 height=40 alt>
PUCK'S BLOG
</a>
<button class="navbar-toggler collapsed" type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<i class="fas fa-bars"></i>
</button>
<div class="navbar-collapse collapse" id=navbarCollapse>
<ul class="navbar-nav mr-auto">
<li class=nav-item>
<a class=nav-link href=https://blog.puckwang.com/>
Home
</a>
</li>
<li class=nav-item>
<a class=nav-link href=https://blog.puckwang.com/about/>
About
</a>
</li>
<li class=nav-item>
<a class=nav-link href=https://blog.puckwang.com/archives/>
Archives
</a>
</li>
<li class=nav-item>
<a class=nav-link href=https://blog.puckwang.com/categories/>
Categories
</a>
</li>
<li class=nav-item>
<a class=nav-link href=https://blog.puckwang.com/tags/>
Tags
</a>
</li>
<li class=nav-item>
<a class=nav-link href=https://blog.puckwang.com/projects/>
MyProjects
</a>
</li>
</ul>
<div class=social-icons>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//www.facebook.com/puckwang14><i class="fab fa-facebook-square"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//twitter.com/puckwang14><i class="fab fa-twitter"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//github.com/puckwang><i class="fab fa-github"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//linkedin.com/in/puckwang><i class="fab fa-linkedin"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href="//stackoverflow.com/users/7699156/puckwang?tab=profile"><i class="fab fa-stack-overflow"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//g.dev/puckwang><i class="fab fa-google"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=https://blog.puckwang.com/index.xml><i class="fas fa-rss"></i></a>
</div>
</div>
</div>
</nav>
<style type=text/css>.feature-image{background-image:linear-gradient( rgba(0,0,0,.15),rgba(0,0,0,.15) ),url(https://blog.puckwang.com/images/hero-main.jpg);height:500px}.feature-image-text{margin-top:20px}@media(min-width:1200px){.feature-image{background-position:0 30%}}@media(max-width:768px){.feature-image{height:250px;background-position:0 0}}</style>
<header class=feature-image>
<div class=feature-image-text>
</div>
</header>
<div class=main>
<div class="container mt-4 post">
<h1>利用 GPG 簽署 git commit</h1>
<div class=mb-3>
<small>
<i class="fas fa-user-edit"></i>&nbsp;作者<strong> Puck Wang</strong>
| <i class="far fa-calendar-alt"></i>&nbsp;建立於 2019-04-03 16:04&nbsp;
| <i class="far fa-calendar-alt"></i>&nbsp;更新於 2021-12-12 06:36&nbsp;
| <i class="fas fa-code-branch"></i>&nbsp;版本 bfd595b&nbsp;
| <i class="fa fa-folder" title=Tags aria-hidden=true></i>&nbsp;分類: <a href=https://blog.puckwang.com/categories/%E7%B2%BE%E9%81%B8/>精選</a>, <a href=https://blog.puckwang.com/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/>版本控制</a>
| <i class="fa fa-tags" title=Tags aria-hidden=true></i>&nbsp;標籤: <a href=https://blog.puckwang.com/tags/github/>Github</a>, <a href=https://blog.puckwang.com/tags/gitlab/>Gitlab</a>, <a href=https://blog.puckwang.com/tags/gpg/>GPG</a>, <a href=https://blog.puckwang.com/tags/verified/>Verified</a>, <a href=https://blog.puckwang.com/tags/git/>git</a>, <a href=https://blog.puckwang.com/tags/%E8%BA%AB%E4%BB%BD%E8%AD%98%E5%88%A5/>身份識別</a>
</small>
</div>
<div class="share-icons d-flex justify-content-center d-print-none">
<a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fblog.puckwang.com%2fposts%2f2019%2fsign_git_commit_with_gpg%2f&text=%e5%88%a9%e7%94%a8%20GPG%20%e7%b0%bd%e7%bd%b2%20git%20commit&tw_p=tweetbutton" class=p-2 title="Share on Twitter" target=_blank rel=nofollow>
<div>
<span class=fa-stack>
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
</span>
</div>
<div class="fa-inverse text-center"><small>Tweet</small></div>
</a>
<a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.puckwang.com%2fposts%2f2019%2fsign_git_commit_with_gpg%2f&t=%e5%88%a9%e7%94%a8%20GPG%20%e7%b0%bd%e7%bd%b2%20git%20commit" class=p-2 title="Share on Facebook" target=_blank rel=nofollow>
<div>
<span class=fa-stack>
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
</span>
</div>
<div class="fa-inverse text-center"><small>Share</small></div>
</a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.puckwang.com%2fposts%2f2019%2fsign_git_commit_with_gpg%2f&title=%e5%88%a9%e7%94%a8%20GPG%20%e7%b0%bd%e7%bd%b2%20git%20commit&source=mattbutton.com" class=p-2 title="Share on LinkedIn" target=_blank rel=nofollow>
<div>
<span class=fa-stack>
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
</span>
</div>
<div class="fa-inverse text-center"><small>Share</small></div>
</a>
<a href=javascript:window.print() title="Print this article" class=p-2 rel=nofollow>
<div>
<span class=fa-stack>
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fa fa-print fa-stack-1x fa-inverse"></i>
</span>
</div>
<div class="fa-inverse text-center"><small>Print</small></div>
</a>
</div>
<div class="mt-4 mb-5 main-content">
<p>GPG 全名為 GNU Privacy Guard 也可以簡稱為 GnuPG，他是一個加密軟體，但也可以用來驗證身份。</p>
<p>今天就要來將我們 git commit 加上 GPG 簽署，讓它 Push 到 Github 等代管平台後，別人可以確定這份 Commit 是你提交的。</p>
<h2 id=安裝>安裝</h2>
<h3 id=homebrew>Homebrew</h3>
<p>如果系統是 MacOS 的人，且有裝 Homebrew 就可以直接用它來安裝，套件名稱為 <a href=https://formulae.brew.sh/formula/gnupg>gnupg</a></p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>brew install gnupg
</code></pre></div><h3 id=other>Other</h3>
<p>對於其他系統或者是沒有 Homebrew 的人，可以直接到 GnuPG <a href=https://www.gnupg.org/download/#binary>官方網站</a>下載安裝檔。</p>
<h2 id=產生-gpg-keys>產生 GPG keys</h2>
<blockquote>
<p>如果有不想打指令的人，可以跳過這段，改使用<a href=#use_GPG_Suite>軟體</a>去產生 GPG Keys。</p>
</blockquote>
<p>請打開終端機 (<code>terminal</code>) 執行以下指令去產生 Key，如果在這裡出現 <code>找不到指令</code> 的錯誤，請檢查是否有安裝成功。</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>gpg --full-generate-key
</code></pre></div><p>執行結果如下，過程中會詢問一些問題，請依照自己需求回答，當然也可以都使用預設設定。</p>
<p>首先會要選擇 Key 的類型，基本上用預設的 RSA & RSA 就可以了。</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>請選擇你要使用的金鑰種類:
   (1) RSA 和 RSA (預設)
   (2) DSA 和 Elgamal
   (3) DSA (僅能用於簽署)
   (4) RSA (僅能用於簽署)
你要選哪一個? 1
</code></pre></div><p>再來會要輸入 Key 的長度，github 是建議 4096 位元。</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>RSA 金鑰的長度可能介於 1024 位元和 4096 位元之間.
你想要用多大的金鑰尺寸? (2048) 4096
你所要求的金鑰尺寸是 4096 位元
</code></pre></div><p>接下來會詢問 Key 的有效期限，沒有特殊需求選 <code>金鑰不會過期</code> 就可以了。</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>請指定這把金鑰的有效期限是多久.
         0 = 金鑰不會過期
      &lt;n&gt;  = 金鑰在 n 天後會到期
      &lt;n&gt;w = 金鑰在 n 週後會到期
      &lt;n&gt;m = 金鑰在 n 月後會到期
      &lt;n&gt;y = 金鑰在 n 年後會到期
金鑰的有效期限是多久? (0) 0
金鑰完全不會過期
</code></pre></div><p>最後會跟你確認是否有問題。</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>以上正確嗎? (y/N) Y
</code></pre></div><p>確認完後會要你輸入基本資料及安全密碼。</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>GnuPG 需要建構使用者 ID 以識別你的金鑰.

真實姓名: &lt;Name&gt;
電子郵件地址: &lt;Email&gt;
註釋:
你選擇了這個使用者 ID:
    <span style=color:#a31515>&#34;&lt;Name&gt; &lt;&lt;Email&gt;&gt;&#34;</span>

變更姓名(N), 註釋(C), 電子郵件地址(E)或確定(O)/退出(Q)? O
</code></pre></div><p>到這邊資料都輸入完了，等它產生完就會看到如下的畫面。</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>我們需要產生大量的隨機位元組. 這個時候你可以多做一些事情
(像是敲打鍵盤, 移動滑鼠, 讀寫硬碟之類的)
這會讓隨機數字產生器有更多的機會獲得夠多的亂數.
我們需要產生大量的隨機位元組. 這個時候你可以多做一些事情
(像是敲打鍵盤, 移動滑鼠, 讀寫硬碟之類的)
這會讓隨機數字產生器有更多的機會獲得夠多的亂數.
gpg: /Users/user/.gnupg/trustdb.gpg: 建立了信任資料庫
gpg: 金鑰 xxxxxxxxxxxxxxx 已標記成徹底信任了
gpg: 目錄 <span style=color:#a31515>&#39;/Users/user/.gnupg/openpgp-revocs.d&#39;</span> 已建立
gpg: revocation certificate stored as <span style=color:#a31515>&#39;/Users/user/.gnupg/openpgp-revocs.d/xxxxxxxxxxxxxxx.rev&#39;</span>
公鑰和私鑰已建立及簽署.

pub   rsa4096 2019-04-02 [SC]
      0D69E11F12BDBA077B3726AB4E1F799AA4FF2279
uid                      <span style=color:#a31515>&#34;&lt;Name&gt; &lt;&lt;Email&gt;&gt;&#34;</span>
sub   rsa4096 2019-04-02 [E]
</code></pre></div><p>這個就是 GPG Keys 的 Fingerprint (指紋) <code>0D69E11F12BDBA077B3726AB4E1F799AA4FF2279</code> ，
而他與 <code>Long key ID</code> 及 <code>Short key ID</code> 的關係如下表:</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>Fingerprint: 0D69E11F12BDBA077B3726AB4E1F799AA4FF2279
Long key ID:                         4E1F799AA4FF2279
Short key ID:                                A4FF2279
</code></pre></div><p>可見兩個不同長度的 ID 只是截取 Fingerprint 的部分方便辨識而已，當有碰撞時就會變長了。</p>
<h2 id=提交公鑰到-github--gitlab--bitbucket>提交公鑰到 Github / Gitlab / Bitbucket</h2>
<p>使用 <code>gpg --list-secret-keys</code> 去顯示出所有包含公要與私鑰的 GPG Keys。</p>
<p>將要使用的 Fingerprint (指紋) 複製起來，以下範例的 Fingerprint 為 <code>0D69E11F12BDBA077B3726AB4E1F799AA4FF2279</code> 。</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ gpg --list-secret-keys

gpg: 正在檢查信任資料庫
gpg: marginals needed: 3  completes needed: 1  trust model: pgp
gpg: 深度: 0  有效:   1  已簽署:   0  信任: 0-, 0q, 0n, 0m, 0f, 1u
/Users/user/.gnupg/pubring.kbx
---------------------------------
sec   rsa4096 2019-04-02 [SC]
      0D69E11F12BDBA077B3726AB4E1F799AA4FF2279
uid           [ultimate] &lt;Name&gt; <span style=color:#a31515>&lt;&lt;Email&gt;&gt;
</span><span style=color:#a31515>ssb   rsa4096 2019-04-02 [E</span>]
</code></pre></div><p>執行 <code>gpg --armor --export &lt;Fingerprint></code> ，承上範例的 Fingerprint 如下</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>gpg --armor --export 0D69E11F12BDBA077B3726AB4E1F799AA4FF2279
</code></pre></div><p>它會輸出公鑰請將它貼到你的 Github / Gitlab / Bitbucket 設定中的 GPG Key 中。</p>
<p>公鑰長得像這樣，但長度會依產生時設定而定：</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>-----BEGIN PGP PUBLIC KEY BLOCK-----
OVG48HWL9GV5P8HG1ZE51VUAJR47WF9H5UGRGX01ZB9I6LVRV55
B7SF1KY5H026LT7J9FL9G67I1EMPR4UIJAA6W3QPWRB3QGYRJ0DP
AMR2XJAI69NM5LBIZJR7GHY7JPI5O1OA07D008M7BDSTP3VMS0ND
FWB1BPVR277S0611F6NQJCSJLRBTW9CJ54WN31ZK3JR0N
=SSDQ

-----END PGP PUBLIC KEY BLOCK-----
</code></pre></div><h2 id=提交包含簽署的-commit>提交包含簽署的 Commit</h2>
<p>執行 <code>git config --global user.signingkey &lt;Fingerprint></code> 為 git 設定 Fingerprint。承之前範例的 Fingerprint 如下</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:green># 僅限此倉庫</span>
git config user.signingkey 0D69E11F12BDBA077B3726AB4E1F799AA4FF2279

<span style=color:green># 全域設定</span>
git config --global user.signingkey 0D69E11F12BDBA077B3726AB4E1F799AA4FF2279
</code></pre></div><p>接下來在每次 Commit 時加上 <code>-S</code> 就可以簽署了。</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>git commit -S -m <span style=color:#a31515>&#34;Add xxx.txt&#34;</span>
</code></pre></div><p>如果不想每次都加上 <code>-S</code> 可以做以下設定</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:green># 僅限此倉庫</span>
git config commit.gpgsign true

<span style=color:green># 全域設定</span>
git config --global commit.gpgsign true
</code></pre></div><p>在 Commit 過程中會要求要輸入 GPG 的安全密碼。</p>
<p>推上去遠端倉庫後，就可以在 Commit 紀錄中看到被標示為 <code>Verified </code> 了</p>
<div class=image>
<figure class=figure>
<img src=https://i.imgur.com/rvXVAk0.png class="figure-img img-fluid rounded" alt="Github commit 已驗證的截圖">
<figcaption class="figure-caption text-center">Github commit 已驗證的截圖</figcaption>
</figure>
</div>
<h2 id=use_GPG_Suite>GPG Suite</h2>
<p>懶得打指令的也可以用 GPG Suite 來產生與管理 GPG Keys，不過圖形化介面的東西就不詳細介紹了。</p>
<p>GPG Suite 官網: <a href=https://gpgtools.org/>https://gpgtools.org/</a></p>
<div class=image>
<figure class=figure>
<img src=https://gpgtools.org/images/screenshots/gka-key-list.1506349762.png class="figure-img img-fluid rounded" alt=官方提供的截圖>
<figcaption class="figure-caption text-center">官方提供的截圖</figcaption>
</figure>
</div>
<h2 id=故障排除>故障排除</h2>
<p>如果在下 <code>git commit</code> 後出現這個錯誤：</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>error: gpg failed to sign the data
fatal: failed to write commit object
</code></pre></div><p>請嘗試以下兩種解法</p>
<h3 id=解法一>解法一</h3>
<p>請執行 <code>echo "test" | gpg --clearsign</code> 檢查看看是 git 的問題還是 gpg 的問題。</p>
<p>如果可以執行正常，請檢查 git 設定是否正確，否之如果出現這個錯誤：</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>gpg: 簽署時失敗: Inappropriate ioctl for device
gpg: [stdin]: clear-sign failed: Inappropriate ioctl for device
</code></pre></div><p>請將 <code>export GPG_TTY=$(tty)</code> 加到你的 <code>.bashrc</code> 或 <code>.zshrc</code>，之後重啟終端機或執行重讀指令 <code>. ~/.zshrc</code> or <code>. ~/.bashrc</code></p>
<p>再執行一次 <code>echo "test" | gpg --clearsign</code> 看看是成功執行。</p>
<h3 id=解法二>解法二</h3>
<p>安裝 pinentry-mac</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>brew install pinentry-mac
</code></pre></div><p>將以下設定新增至 <code>~/.gnupg/gpg.conf</code></p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>no-tty
</code></pre></div><p>以下設定新增至 <code>~/.gnupg/gpg-agent.conf</code></p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>pinentry-program /usr/local/bin/pinentry-mac
</code></pre></div><p>清除背景執行的 <code>gpg-agent</code></p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>killall gpg-agent
</code></pre></div><p>執行 <code>echo "test" | gpg --clearsign</code> 看看是成功執行。</p>
<div>
<br>
<h3>
感謝閱讀！
</h3>
<div>
喜歡這篇文章或是有幫助到你嗎？ 歡迎分享給你的朋友！
</div>
<br>
<div>
有任何問題、回饋或您認為我會感興趣的任何東西嗎？ 請在下面發表評論，或者是<a href=https://blog.puckwang.com/about target=_blank>直接聯絡我</a>。
</div>
<br>
</div>
<div class="share-icons d-flex justify-content-center d-print-none">
<a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fblog.puckwang.com%2fposts%2f2019%2fsign_git_commit_with_gpg%2f&text=%e5%88%a9%e7%94%a8%20GPG%20%e7%b0%bd%e7%bd%b2%20git%20commit&tw_p=tweetbutton" class=p-2 title="Share on Twitter" target=_blank rel=nofollow>
<div>
<span class=fa-stack>
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
</span>
</div>
<div class="fa-inverse text-center"><small>Tweet</small></div>
</a>
<a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.puckwang.com%2fposts%2f2019%2fsign_git_commit_with_gpg%2f&t=%e5%88%a9%e7%94%a8%20GPG%20%e7%b0%bd%e7%bd%b2%20git%20commit" class=p-2 title="Share on Facebook" target=_blank rel=nofollow>
<div>
<span class=fa-stack>
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
</span>
</div>
<div class="fa-inverse text-center"><small>Share</small></div>
</a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.puckwang.com%2fposts%2f2019%2fsign_git_commit_with_gpg%2f&title=%e5%88%a9%e7%94%a8%20GPG%20%e7%b0%bd%e7%bd%b2%20git%20commit&source=mattbutton.com" class=p-2 title="Share on LinkedIn" target=_blank rel=nofollow>
<div>
<span class=fa-stack>
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
</span>
</div>
<div class="fa-inverse text-center"><small>Share</small></div>
</a>
<a href=javascript:window.print() title="Print this article" class=p-2 rel=nofollow>
<div>
<span class=fa-stack>
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fa fa-print fa-stack-1x fa-inverse"></i>
</span>
</div>
<div class="fa-inverse text-center"><small>Print</small></div>
</a>
</div>
<div>
<hr>
<div class="p-4 row justify-content-center" style=align-items:center>
<div class=col-2>
<img src=https://blog.puckwang.com/images/author.jpg alt="Puck Wang" class="img-fluid rounded-circle" width=150>
</div>
<div class=col-8 style=vertical-align:middle>
<h4>
Puck Wang
</h4>
<p>
Hi！ 我是 Puck Wang，這個部落格的作者，是一位全端網站開發者，常使用 .Net 和 React 進行開發，專注於架構研究，你可以在這個部落格看到我精選的筆記內容，希望對你會有所幫助。
</p>
<p>
更多關於我的訊息，可至關於<a href=https://blog.puckwang.com/about target=_blank>關於</a>頁面。
</p>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//www.facebook.com/puckwang14><i class="fab fa-facebook-square"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//twitter.com/puckwang14><i class="fab fa-twitter"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//github.com/puckwang><i class="fab fa-github"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//linkedin.com/in/puckwang><i class="fab fa-linkedin"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href="//stackoverflow.com/users/7699156/puckwang?tab=profile"><i class="fab fa-stack-overflow"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//g.dev/puckwang><i class="fab fa-google"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=https://blog.puckwang.com/index.xml><i class="fas fa-rss"></i></a>
</div>
</div>
</div>
</div>
</div>
<div class="sidebar d-print-none d-none d-xl-block">
<div id=toc>
<h2>目錄</h2>
<nav id=TableOfContents>
<ul>
<li><a href=#安裝>安裝</a>
<ul>
<li><a href=#homebrew>Homebrew</a></li>
<li><a href=#other>Other</a></li>
</ul>
</li>
<li><a href=#產生-gpg-keys>產生 GPG keys</a></li>
<li><a href=#提交公鑰到-github--gitlab--bitbucket>提交公鑰到 Github / Gitlab / Bitbucket</a></li>
<li><a href=#提交包含簽署的-commit>提交包含簽署的 Commit</a></li>
<li><a href=#use_GPG_Suite>GPG Suite</a></li>
<li><a href=#故障排除>故障排除</a>
<ul>
<li><a href=#解法一>解法一</a></li>
<li><a href=#解法二>解法二</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<footer class="mt-auto footer d-print-none">
<div class=container-fluid>
<div class="row justify-content-center">
<div class="col-md-4 col-xl-3">
<h5>Copyright © 2017-2024, Puck Wang; all rights reserved.</h5>
Opinions expressed here are my own and may not reflect those of the company I work for, or the people I work with.
</div>
<div class="col-md-4 col-xl-3">
<h5>Disclaimer</h5>
See <a href=https://blog.puckwang.com/other/disclaimer/>disclaimer</a> of <a href=https://blog.puckwang.com>https://blog.puckwang.com/</a>
</div>
<div class="col-md-4 col-xl-3">
<h5>About This Site</h5>
This blog was created using the <a href=https://gohugo.io/>Hugo</a> static site generator, using
<a href=https://getbootstrap.com/>Bootstrap</a>, using the Silhouette Hugo theme, created by
<a href=https://www.mattbutton.com>Matt Button</a>
</div>
</div>
<hr>
<div class="d-flex justify-content-center icons">
<a class="py-2 px-2 d-none d-lg-inline-block" href=//www.facebook.com/puckwang14><i class="fab fa-facebook-square"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//twitter.com/puckwang14><i class="fab fa-twitter"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//github.com/puckwang><i class="fab fa-github"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//linkedin.com/in/puckwang><i class="fab fa-linkedin"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href="//stackoverflow.com/users/7699156/puckwang?tab=profile"><i class="fab fa-stack-overflow"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=//g.dev/puckwang><i class="fab fa-google"></i></a>
<a class="py-2 px-2 d-none d-lg-inline-block" href=https://blog.puckwang.com/index.xml><i class="fas fa-rss"></i></a>
</div>
</div>
</footer>
<script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script>
<script src=https://unpkg.com/mermaid@8.13.5/dist/mermaid.min.js></script>
</body>
<style>.zoom-in-thumbnail{visibility:hidden;position:fixed;z-index:100000;box-sizing:border-box;border:5px solid #fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.8);opacity:0;pointer-events:none;transition-duration:.3s;transition-delay:.1s;transition-property:opacity}.zoom-in-thumbnail-img{background-repeat:no-repeat;background-size:contain}</style>
<script>const root=document.documentElement;$(function(){mermaid.initialize({startOnLoad:!0}),$(".main-content img, .post img").each(function(){this.complete?generateImageDiv(this):$(this).on("load",function(){generateImageDiv(this)}),this.style.cursor="pointer",$(this).on("mousemove",function(d){let b=d.clientX,c=d.clientY,a;$(this).next().width()>=$(this).next().height()?innerHeight-c<=$(this).next().height()+50?a=getShowXY(this,"top",b,c):a=getShowXY(this,"bottom",b,c):innerWidth-b<=$(this).next().width()+50?a=getShowXY(this,"left",b,c):a=getShowXY(this,"right",b,c),root.style.setProperty("--zoom-image-x",a.x+250+"px"),root.style.setProperty("--zoom-image-y",a.y+"px")}),$(this).on("click",function(a){window.open(this.src)})})});function getShowXY(d,e,a,b){let c=$(d).next();switch(e){case'top':a-=c.width()/2,b-=c.height(),b-=25;break;case'bottom':a-=c.width()/2,b+=25;break;case'right':b-=c.height()/2,a+=25;break;case'left':a-=c.width(),b-=c.height()/2,a-=25;break}return{x:a,y:b}}function generateImageDiv(c){var e=screen.width*.6,f=screen.height*.5,d=0,a=c.naturalHeight,b=c.naturalWidth,g;b>e&&(d=e/b,b=e,a=a*d),a>f&&(d=f/a,a=f,b=b*d),g="<div class='zoom-in-thumbnail'><div class='zoom-in-thumbnail-img' style=\"background-color: white; background-image:url('"+c.src+"'); height: "+a+"px; width: "+b+'px;"></div></div>',$(c).after(g)}</script>
</html>